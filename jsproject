<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <section class="container">
        <form id="my-form">
    
            <label for="price">Selling Price:</label>
            <input type="text" id="price">
            <label for="name">Product Name:</label>
            <input type="text" id="dish">
            <label for="category">Choose Category:</label>
            <select id="category">
                <option value="electronics">Electronics</option>
                <option value="food">Food</option>
                <option value="skincare">Skin Care</option>
          <input class="btn" type="submit" value="Submit">
        </form>
        <ul id="Products"> </ul>
      </section>
  
      <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      <script>
        var inputs=document.getElementById('my-form');
        inputs.addEventListener('submit', function(e){
        e.preventDefault();
        var priceInput= document.getElementById('price').value;
        var nameInput= document.getElementById('name').value;
        var categoryInput= document.getElementById('category').value;
        var orders={
        price: priceInput,
        name: nameInput,
        category: categoryInput
        }
        axios.post('https://crudcrud.com/api/73bcefe3eae74ba48c52d8a4828f1edb/orders', orders).then((response) =>{
                console.log(response);
            }).catch((err) =>{
                console.log(err);
            })
        var userid=nameInput
        localStorage.setItem(userid, JSON.stringify(orders));
        })
        window.addEventListener('load', () =>{
        axios.get('https://crudcrud.com/api/73bcefe3eae74ba48c52d8a4828f1edb/orders').then((response) =>{
                console.log(response);
                for(var i=0; i<response.data.length; i++){
                showorderdetails(response.data[i]);
                }
            }).catch((err) =>{
                console.log(err);
            })
        })
        
        function showorderdetails(orders){
            var parent = document.getElementById('Products');
            var child=`<li id='orders._id'> ${orders.price} - ${orders.name} - ${orders.category}
            <button onclick=deleteorder('${orders._id}')> Delete</button>
            </li>`;
            
            parent.appendChild(child);
        }
        function deleteorder(orderid){
            localStorage.removeItem(orders.name);
            axios.delete(`https://crudcrud.com/api/73bcefe3eae74ba48c52d8a4828f1edb/${orderid}`)
            .then((res) => removeorder(orderid))
            .catch((err) => console.error(err));
        }  
        function removeorder(orderid){
            var parent=document.getElementById('Products');
            var childtoremove=document.getElementById(orderid);
            parent.removeChild(childtoremove);
        }
      </script>
    
</body>
</html>
